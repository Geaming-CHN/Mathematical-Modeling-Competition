# 灰色关联分析用于系统分析

！仅用于国赛，此方法在国外研究较少，属于国内方法，不建议美赛使用。

- [灰色关联分析用于系统分析](#灰色关联分析用于系统分析)
  - [灰色关联分析概述](#灰色关联分析概述)
  - [系统分析](#系统分析)
      - [Step1：绘制统计图](#step1绘制统计图)
      - [Step2：确定分析数列](#step2确定分析数列)
      - [Step3：对变量进行预处理](#step3对变量进行预处理)
      - [Step4：计算子序列中各个指标与母序列的关联系数](#step4计算子序列中各个指标与母序列的关联系数)
      - [Step5：求解灰色关联度](#step5求解灰色关联度)
      - [Step6：由关联度得到结论](#step6由关联度得到结论)
  - [讨论：](#讨论)
## 灰色关联分析概述

数理统计中的**回归分析**、**方差分析**、**主成成分分析**等都是用来进行系统分析的方法。这些方法都有下述不足之处：

1. 要求有大量数据，数据量少就难以找出统计规律；
2. 要求样本服从某个典型的概率分布，要求各因素数据与系统特征数据之间呈线性关系且各因素之间彼此无关，这种要求往往难以满足；
3. 计算量大，一般要靠计算机帮助；
4. 可能出现量化结果与定性分析结果不符的现象，导致系统的关系和规律遭到歪曲和颠倒；

灰色关联分析方法弥补了采用数理统计方法作为系统分析所导致的缺憾。它对样本量的多少和样本有无规律都同样适用，而且计算量小，十分方便，更不会出现量化结果与定性分析结果不符的情况。

**基本思想：**根据序列曲线几何形状的相似程度来判断其联系是否紧密。曲线越接近，相应序列之间的关联度就越大，反之就越小。

## 系统分析

> 下表为某地区国内生产总值的统计数据（以百万元计），问该地区从2000到2005年之间哪一种产业对GDP总量影响最大。
>
> | 年份 | 国内生产总值 | 第一产业 | 第二产业 | 第三产业 |
> | ---- | ------------ | -------- | -------- | -------- |
> | 2000 | 1988         | 386      | 839      | 763      |
> | 2001 | 2061         | 408      | 846      | 808      |
> | 2002 | 2335         | 422      | 960      | 953      |
> | 2003 | 2750         | 482      | 1258     | 1010     |
> | 2004 | 3356         | 511      | 1577     | 1268     |
> | 2005 | 3806         | 561      | 1893     | 1352     |

#### Step1：绘制统计图

> ![1](https://cdn.jsdelivr.net/gh/GEAMING-CHN/images/blogimg/%E6%95%B0%E6%A8%A1/1.jpg)

画图后配上简单的分析：

> 1. 四个变量均呈现上升的趋势
> 2. 第二产业的增幅较为明显
> 3. 第二产业和第三产业的差距在后三年相差更大

#### Step2：确定分析数列

- 母序列（又称参考数列、母指标）：能反映系统行为特征的数据序列
  ->类似于因变量$Y$，此处记为$X_0$
- 子序列（又称比较数列、子指标）：影响系统行为的因素组成的数据序列
  ->类似于自变量$X$，此处记为$(X_1,X_2,\cdots,X_m)$

> 在本例中：国内生产总值就是母序列，第一、第二和第三产业就是子序列。

#### Step3：对变量进行预处理

两个目的：去量纲、缩小变量范围简化计算

对母序列和子序列中的每个指标进行预处理：先求出每个指标的均值，再用该指标中的每个元素都除以其均值。

> ![image-20220809093602857](https://cdn.jsdelivr.net/gh/GEAMING-CHN/images/blogimg/数模/image-20220809093602857.png)

#### Step4：计算子序列中各个指标与母序列的关联系数

$X_0=(x_0(1),x_0(2),\cdots,x_0(n))^T \rightarrow 母序列$

$\left.\begin{aligned} &X_1=(x_1(1),\cdots,x_1(n))^T\\ &\cdots\\&X_2=(x_m(1),\cdots,x_m(n))^T\end{aligned}\right\}\rightarrow子序列$

$\large两极最小差 a=\min\limits_{i}\min\limits_{k}|x_0(k)-x_i(k)|$

$\large两极最大差 a=\max\limits_{i}\max\limits_{k}|x_0(k)-x_i(k)|$

> ![image-20220809095240446](https://cdn.jsdelivr.net/gh/GEAMING-CHN/images/blogimg/%E6%95%B0%E6%A8%A1/image-20220809095240446.png)
>
> ![image-20220809095302127](https://cdn.jsdelivr.net/gh/GEAMING-CHN/images/blogimg/%E6%95%B0%E6%A8%A1/image-20220809095302127.png)

$\Large \gamma(x_0(k),x_i(k))=\frac{a+\rho b}{|x_0(k)-x_1(k)|+\rho b}\quad\rho :分辨系数（一般取0.5）$

#### Step5：求解灰色关联度

$\Large X_0和X_i的灰色关联度： \gamma(X_0,X_i)=\frac{1}{n}\sum\limits_{k=1}^n\gamma(x_0(k),x_i(k))$

> ![image-20220809100900128](https://cdn.jsdelivr.net/gh/GEAMING-CHN/images/blogimg/%E6%95%B0%E6%A8%A1/image-20220809100900128.png)

#### Step6：由关联度得到结论

> 通过比较三个子序列和母序列的关联度可以得到结论：该地区在2000年至2005年间的国内生产总值受到第三产业的影响最大（其灰色关联度最大）。

## 讨论：

1. 什么时候使用标准化回归，什么时候用灰色关联分析？
   当样本个数$n$较大时，一般使用标准化回归；当样本个数$n$较少时，才使用灰色关联分析。
2. 如果母序列中有各个指标，应该怎么分析？
   例如：$Y_1$和$Y_2$是母序列，$X_1,X_2,\cdots,X_m$是子序列
   那么我们先计算，$Y_1$和$X_1,X_2,\cdots,X_m$的灰色关联度进行分析；再计算$Y_2$和$X_1,X_2,\cdots,X_m$的灰色关联度进行分析。

